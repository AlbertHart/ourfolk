<html>
    <head>
        <title>Chart Test</title>

    <!-- Bootstrap core CSS -->
    <link href="./flatlab/css/bootstrap.min.css" rel="stylesheet">
    <link href="./flatlab/css/bootstrap-reset.css" rel="stylesheet">
    <!--external css-->
    <link href="./flatlab/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    
  
    <!-- Custom styles for this template -->
    <link href="./flatlab/css/style.css" rel="stylesheet">
    <link href="./flatlab/css/style-responsive.css" rel="stylesheet" />

    <link rel="stylesheet" href="paf_styles.css"></link>


            <script async src="https://cse.google.com/cse.js?cx=003736524176309227229:whsyk9ptpff"></script>
            <script src="./alh_common/alh_sprintf.js?v=278"></script>
            <script src="./alh_common/alh_common.js?v=278"></script>

    <!-- ged_common is not supposed to change much -->
    <script src="ged_common.js?v=278"></script>

    <script src="bk_data.js?v=278"></script>



    <script>

        load_js_files();
        

        

    // this is ruin only after ged_source is set.
    function process_ged_file()
    {
        console.log(get_self());

        if (!ged_source)
        {
            console.log("ged_source not set");
            return;
        }
    
        read_ged_file();

        do_ancestors(id);
    }
        
     </script> 
            
         


    </head>
    <body>

        <style>
            td {
                xxbackground-color: #fff;
                font-size: small;
            }
            tr {
                background-color: #e0e0d0;
            }
            .tdp {
                xxbackground-color: #eee;
                border: 1px solid #aaa;
                margin: 4px;
            }
            .aht5 {
                background-image: url("./images/backgrounds/aht5.png");

                background-repeat:   no-repeat;
                background-position: center center;           
                yybackground-color: #fff;
                width: 25px;
            }
            .ahtup {
                background-image: url("./images/backgrounds/aht-pup.png");

                background-repeat:   no-repeat;
                background-position: center center;           
                yybackground-color: #fff;
                width: 25px;
            }
            .ahtdn {
                background-image: url("./images/backgrounds/aht-pdn.png");

                background-repeat:   no-repeat;
                background-position: center center;           
                yybackground-color: #fff;
                width: 25px;
            }


            .ahtpup {
                background-image: url("./images/backgrounds/aht-pup.png");

                background-repeat:   no-repeat;
                background-position: center center;           
                yybackground-color: #fff;
                width: 25px;
            }
            .ahtpdn {
                background-image: url("./images/backgrounds/aht-pdn.png");

                background-repeat:   no-repeat;
                background-position: center center;           
                yybackground-color: #fff;
                width: 25px;
            }

            .image_container {
                width: 10vw;
                height: 12vw;
                xxbackground-image: url("http://i.stack.imgur.com/2OrtT.jpg");
                background-size: contain;
                background-repeat: no-repeat;
                background-position: 50% 50%;
            }â€‹



        </style>

        <table border=0 width=80% align=center >

        <!--
            <tr>
                
                <td width=10%><b>Person</b></td>
                <td width=10%><b>Parents</b></td>
                <td width=3%>3</td>
                <td width=15%><b>Grand-Parents</b></td>
                <td width=3%>3</td>
                <td width=3%>3</td>
                <td width=20s%><b>Great Grand-Parents</b></td>
                <td width=3%>3</td>
                <td width=3%>3</td>
                <td width=20%><b>Great Great Grand-Parents</b></td>
            </tr>
        -->
        <!--
            <tr>
                
                <td  width=10% ><b>Person</b></td>
                <td width=10% colspan=2><b>Parents</b></td>
                <td width=20% colspan=3><b>Grand-Parents</b></td>
                <td width=30% colspan=3 ><b>Great Grand-Parents</b></td>
                <td width=30% ><b>Great Great Grand-Parents</b></td>
            </tr>

        -->
            <!--
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
                <td>6</td>
                <td>7</td>
                <td>8</td>
                <td>9</td>
                <td>10</td>
            </tr>
        -->

        <tr>
                <td>&nbsp;</td>
                <td>v</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;&nbsp;&nbsp;</td>
                <td>&nbsp;</td>
            </tr>


            <tr>
                
                <td ><b>Person</b></td>
                <td colspan=2 ><b>Parents</b></td>
                
                <td colspan=3 ><b>Grand-Parents</b></td>
          
              
                <td colspan=3 ><b>Great Grand-Parents</b></td>
             
                <td ><b>Great Great Grand-Parents</b></td>
            </tr>


            <tr>
                
                <td colspan=1 rowspan=15></td>
                <td colspan=1 rowspan=7></td>
                <td colspan=3 rowspan=3></td>
                <td colspan=3 rowspan=1 ></td>
                <td colspan=1 rowspan=4 class=aht5></td>
                <td colspan=1 rowspan=2 class=tdp id='GGGP1111'></td>
                
            </tr>

            <tr>
                
                <td colspan=1 rowspan=2 class=ahtup></td>
                <td colspan=2 rowspan=2 class=tdp id='GGP111'>GGP111</td>
                
            </tr>

            <tr>
                

                <td colspan=1 rowspan=2 class=tdp id='GGGP1112'></td>
                
            </tr>
 
            <tr>
                

                <td colspan=1 rowspan=4 class=ahtpup></td>
                <td colspan=4 rowspan=2 class=tdp id='GP11'></td>
                <td colspan=1 rowspan=2></td>
            </tr>
            <tr>
                
                
                <td colspan=1 rowspan=4 class=aht5></td>
                <td colspan=1 rowspan=2 class=tdp id='GGGP1121'></td>
                
            </tr>

            <tr>
                
                <td colspan=2 rowspan=2></td>
                <td colspan=1 rowspan=2 class=ahtdn></td>
                <td colspan=2 rowspan=2 class=tdp id='GGP112'></td>
                
            </tr>

            <tr>
                
    
                <td colspan=1 rowspan=2 class=tdp id='GGGP1122'></td>
                
            </tr>

            <tr>
                
                <td colspan=3 rowspan=2 class=tdp id='P1'></td>
                <td colspan=2 rowspan=2> </td>
                <td colspan=2 rowspan=2></td>
            </tr>

            <tr>
                
                <td colspan=1 rowspan=4 class=aht5></td>
                <td colspan=1 rowspan=2 class=tdp id='GGGP1211'></td>
            </tr>

            <tr>
                
                <td colspan=1 rowspan=6></td>
                <td colspan=1 rowspan=4 class=ahtpdn></td>
                
                <td colspan=2 rowspan=2></td>
                <td colspan=1 rowspan=2 class=ahtup></td>
                <td colspan=2 rowspan=2 class=tdp id='GGP121'></td>
            </tr> <tr>
                

                <td colspan=1 rowspan=2 class=tdp id='GGGP1212'></td>
            </tr> <tr>
                
                <td colspan=4 rowspan=2 class=tdp id='GP12'></td>
                <td colspan=1 rowspan=2> </td>
            </tr> <tr>
                
                <td colspan=1 rowspan=4 class=aht5></td>
                <td colspan=1 rowspan=2 class=tdp id='GGGP1221'></td>
            </tr> <tr>
                
                <td colspan=3 rowspan=2></td>
                <td colspan=1 rowspan=2 class=ahtdn></td>
                <td colspan=2 rowspan=2 class=tdp id='GGP122'></td>
            </tr> <tr>
                
                <td colspan=1 rowspan=2 class=tdp id='GGGP1222'></td>


            </tr> <tr>
                
                <td colspan=4 rowspan=2 class=tdp id='Person'></td>
                <td colspan=4 rowspan=2 ></td>
            </tr>


        </tr> <tr>
            
            
            <td colspan=1 rowspan=4 class=aht5></td>
            <td colspan=1 rowspan=2 class=tdp id='GGGP2111'></td>
        </tr> <tr>
            
            <td colspan=1 rowspan=15></td>
            <td colspan=1 rowspan=6></td>
            <td colspan=3 rowspan=2></td>
            <td colspan=1 rowspan=2 class=ahtup></td>
            <td colspan=2 rowspan=2 class=tdp id='GGP211'></td>
        </tr> <tr>
            
            <td colspan=1 rowspan=2 class=tdp id='GGGP2112'></td>


        </tr> <tr>
            
            <td colspan=1 rowspan=4 class=ahtpup></td>
            <td colspan=4 rowspan=2 class=tdp id='GP21'></td>
            <td colspan=1 rowspan=2> </td>
     

        </tr><tr>
        
        <td colspan=1 rowspan=4 class=aht5></td>
        <td colspan=1 rowspan=2 class=tdp id='GGGP2121'></td>

    </tr><tr>
        
        <td colspan=2 rowspan=2></td>

        <td colspan=1 rowspan=2 class=ahtdn></td>
        <td colspan=2 rowspan=2 class=tdp id='GGP212'></td>
    </tr><tr>
        

        <td colspan=1 rowspan=2 class=tdp id='GGGP2122'></td>
    </tr>
    S
  

    <tr>
        
        <td colspan=3 rowspan=2 class=tdp id='P2'></td>
        <td colspan=2 rowspan=2> </td>
        <td colspan=2 rowspan=2></td>
    </tr>

    <tr>
        

        <td colspan=1 rowspan=4 class=aht5></td>

        <td colspan=1 rowspan=2 class=tdp id='GGGP2211'></td>
        
    </tr>
    
    
    <tr>
        
        <td colspan=1 rowspan=15></td>
        <td colspan=1 rowspan=4 class=ahtpdn></td>
        <td colspan=2 rowspan=2></td>
        <td colspan=1 rowspan=2 class=ahtup></td>
        <td colspan=2 rowspan=2 class=tdp id='GGP221'></td>
    </tr> <tr>
        
        
        <td colspan=1 rowspan=2 class=tdp id='GGGP2212'></td>


    </tr> <tr>
        
        <td colspan=4 rowspan=2 class=tdp id='GP22'></td>
        <td colspan=1 rowspan=2> </td>
 

    </tr><tr>
    
    <td colspan=1 rowspan=4 class=aht5></td>
    <td colspan=1 rowspan=2 class=tdp id='GGGP2221'></td>

</tr><tr>
    
    <td colspan=3 rowspan=3></td>

    <td colspan=1 rowspan=2 class=ahtdn></td>
    <td colspan=2 rowspan=2 class=tdp id='GGP222'></td>
</tr>

<tr>
    
    <td colspan=1 rowspan=2 class=tdp id='GGGP2222'></td>
</tr>

<tr>
    

    <td colspan=3 rowspan=1 ></td>
    
</tr>



        </table>


    </body>

    <script>
        iperson = 1;
        sid = "Person";
        set_elt(sid,sid);

        for (iparent = 1; iparent <=2; iparent++)
        {
            sid = "P" + iparent;
            set_elt(sid,sid);
            for (igp = 1; igp <=2; igp++)
            {
                sid = "GP" + iparent + igp;
                set_elt(sid,sid);
                for (iggp = 1; iggp <=2; iggp++)
                {
                    sid = "GGP" + iparent + igp + iggp;
                    set_elt(sid,sid);
                    for (igggp = 1; igggp <=2; igggp++)
                    {
                        sid = "GGGP" + iparent + igp + iggp + igggp;
                        set_elt(sid,sid);
                    }
                }
            }
        }


        function set_elt(sid,shtml)
        {
            elt = document.getElementById(sid);
            if (!elt)
                console.log("SID not found: %s", sid);
            //if (shtml == "")
            //    elt.style.display = "none";
            //else
                elt.innerHTML = shtml;
        }
        function clear_elt(sid)
        {
            elt = document.getElementById(sid);
            elt.style.display = "none";
        }
        


	    var iptr;
	    var fptr;
	    
	    
        var ged_objects;

        var generations_to_show = 4;

        var ancestors = [];

        var gen_letters = ["Person", "P", "GP", "GGP", "GGGP"];
        var gen_numbers = [];

        var do_process_ged_file = true;
        console.log("do_process_ged_file: %s", do_process_ged_file);

        
        var id = get_url_var("id");    
        if (id == "")
            id = "1";
        if (id.substr(0,1) != "@")
            id = "@I" + id + "@";
        

        console.log("ID: %s", id);

       

      
            document.addEventListener('DOMContentLoaded', function() {
                //console.log("IN addEventListener");
                //process_ged_file()
                // your code here
                }, false);

        

    

    function do_ancestors(id, use_gallery)
    {
        

        generation = 0;
        ancestors[0] = [id];

        for (generation = 0; generation < generations_to_show; generation++)
        {
            console.log("generation: %s ancestors.length: %s", generation, ancestors[generation].length);
            ancestors[generation + 1] = [];
            for (ia = 0; ia < ancestors[generation].length; ia++)
            {
    

                id = ancestors[generation][ia];
                console.log("generation: %s ia: %s ancestor id: %s", generation, ia, id);
                aptr = get_person(id);
                if (!aptr)
                {
                    console.log("APTR NOT FOUND for ID: %s", id);
                    add_to_array(ancestors[generation + 1], "");
                    add_to_array(ancestors[generation + 1], "");
                    continue;
                }

                pptr = ged_objects[aptr.FAMC];
                if (pptr)
                {
                    console.log("generation: %s ia: %s aptr: %s famc: %s HUSB: %s WIFE: %s", 
                        generation, ia, aptr.code, aptr.famc, pptr.HUSB, pptr.WIFE)
                    if (pptr.HUSB)
                        add_to_array(ancestors[generation + 1], pptr.HUSB);
                    else
                        add_to_array(ancestors[generation + 1], "");
                    
                    if (pptr.WIFE)
                        add_to_array(ancestors[generation + 1], pptr.WIFE);
                    else
                        add_to_array(ancestors[generation + 1], "");
                }
                else
                {
                    add_to_array(ancestors[generation + 1], "");
                    add_to_array(ancestors[generation + 1], "");
                }

            }

            

        }

        //(5) [Array(1), Array(2), Array(4), Array(8), Array(16)]
        //    0: ["@I1@"]
        //    1: (2) ["@I8@", "@I9@"]
        //    2: (4) ["@I98@", "@I103@", "@I443@", "@I444@"]
        //    3: (8) ["@I49@", "@I305@", "@I194@", "@I198@", "@I659@", "@I660@", "@I664@", "@I667@"]
        //    4: (16) ["@I20@", "@I28@", "@I303@", "@I295@", "@I191@", "@I188@", "@I247@", "@I241@", "@I657@", "@I658@", "@I689@", "@I690@", "@I662@", "@I663@", "@I665@", "@I666@"]

        id = ancestors[0][0];
        do_cell(id, "Person");

        for (iparent = 1; iparent <= 2; iparent++)
        {
            sid = "P" + iparent;
            index = iparent-1;
            console.log("sid: %s index: %s", sid, index);
            id = ancestors[1][index];
            do_cell(id, sid);
            for (igp = 1; igp <= 2; igp++)
            {
                sid = "GP" + iparent + igp;
                index = (iparent-1) * 2 + igp - 1;
                console.log("sid: %s index: %s", sid, index);
                id = ancestors[2][index];
                do_cell(id, sid);
                for (iggp = 1; iggp <= 2; iggp++)
                {
                    sid = "GGP" + iparent + igp + iggp;
                    index = (iparent-1) * 4 + (igp-1) * 2 + iggp - 1;
                    console.log("sid: %s index: %s", sid, index);
                    id = ancestors[3][index];
                    do_cell(id, sid);
                    for (igggp = 1; igggp <= 2; igggp++)
                    {
                        sid = "GGGP" + iparent + igp + iggp + igggp;
                        index = (iparent-1) * 8 + (igp-1) * 4 + (iggp - 1) * 2 + igggp - 1;
                        console.log("sid: %s index: %s", sid, index);
                        id = ancestors[4][index];
                        do_cell(id, sid);
                    }
                }
            }
        }


 
        
    }

    
    
    function do_cell(id, sid)
    {
        console.log(get_self(id, sid));
        iptr = get_person(id);
        if (!iptr)
        {
            set_elt(sid, "");
            return;
        }
        shtml = "<table style='width: 25vw;'><tr><td >";
        shtml += sprintf("<a href='ged_person.htm?id=%s'<div class=name>%s</div></a>\n", iptr.id, iptr.full_name);
        shtml += sprintf("<br>%s", get_short_full_dates(iptr));

        shtml += sprintf(": %s: %s", iptr.id, sid);

        shtml += "</td><td>";
        //sleft = "<div style='text-align: center; width:25%; padding-bottom: 15px; padding-right: 15px; float: left; display: block;'>\n";
            sleft = "";
        //get_first_image(iptr, "left", "", true);

        //sleft += "</div>\n";

        var obje_array = get_values_array(iptr.OBJE); // array of one or more values

        for (var ii = 0; ii < obje_array.length; ii++)
        {


            obje = obje_array[ii];



            if (obje.FILE)
            {

                // FILE D:/Dropbox/_VP_Images/ourfolk/images/johnston/dorothy-johnston1930.jpg
                image_file = update_image_path(obje.FILE);
                simage = sprintf("<div class=image_container style='background-image: url(\"%s\");'></div>\n", image_file);
                shtml += simage;
                break;
            }
        }
            
        
        shtml += "</td></tr></table>\n";

        set_elt(sid, shtml);
    }


           
	    
	    
    </script>
</html>