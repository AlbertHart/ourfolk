<!doctype html>
<html>
  <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-152244338-1"></script>
    <script data-ad-client="ca-pub-0704525034147863" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-152244338-1');
    </script>
    
    


    
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Mosaddek">
    <meta name="keyword" content="FlatLab, Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    

    <title>Our Folk</title>

    <!-- Bootstrap core CSS -->
    <link href="./flatlab/css/bootstrap.min.css" rel="stylesheet">
    <link href="./flatlab/css/bootstrap-reset.css" rel="stylesheet">
    <!--external css-->
    <link href="./flatlab/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    
    <!-- for image gallery -->
    <link href="./flatlab/assets/fancybox/source/jquery.fancybox.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="./flatlab/css/gallery.css" />
    
  
    <!-- Custom styles for this template -->
    <link href="./flatlab/css/style.css" rel="stylesheet">
    <link href="./flatlab/css/style-responsive.css" rel="stylesheet" />

    <link rel="stylesheet" href="paf_styles.css"></link>



            <script async src="https://cse.google.com/cse.js?cx=003736524176309227229:whsyk9ptpff"></script>
            <script src="./alh_common/alh_sprintf.js?v=278"></script>
            <script src="./alh_common/alh_common.js?v=278"></script>
            <script src="hart-ged.js?v=278"></script>
            <script src="ged_read.js?v=278"></script>


    <!-- ged_common is not supposed to change much -->
    <script src="ged_common.js?v=278"></script>
    <script src="bk_data.js?v=278"></script>
    <script src="bk_data.js?v=278"></script>

 

  </head>

  <body class="boxed-page">
      <div class="container">
        <section id="container" class="">
             <!--header start-->
             <header class="header white-bg">
                <div class="container">
                    <div class="sidebar-toggle-box">
                        <i class="fa fa-bars"></i>
                    </div>
                    <!--logo start-->
                    <a href="families.htm" class="logo">
                        <img id=logo height='50'>
                        <script>
                            document.getElementById("logo").src = image_path + "/our-folk.jpg";
                        </script>
                    </a>
                    <!--logo end-->
                    <div class="nav notify-row" id="top_menu">
                        <!--  notification start -->
                        <div id=family_name class=title >Our Folk Genealogy Pages
                           <br>(HartGen)</div>
                            <!-- notification dropdown end -->
                        </ul>
                        <!--  notification end -->
                    </div>
                    <div class="top-nav ">
                        <!--search & user info start-->
                            <div class="gcse-search"></div>
                       
                        <!--search & user info end-->
                    </div>
                </div>
            </header>
            <!--header end-->

            <!--sidebar start-->
            <aside>
                <div id="sidebar"  class="nav-collapse ">
                    <script src="sidebar.js"></script>
                </div>
            </aside>
            <!--sidebar end-->
            
            <!--main content start-->
            <section id="main-content">
              <section class=" wrapper">

                <section class="card">
                    <header class="card-header">
                        
                    </header>
                    <div class="card-body">
                        

                        <div id=ged_out>
                        
                    </div>
                </section>
     
              </section>

              <!-- try footer here-->
 
              <div class="text-center">
                    <script>do_footer();</script>
                <a href="#" class="go-top">
                    <i class="fa fa-angle-up"></i>
                </a>
                </div>
            </section>
            <!--main content end-->
            


      </section>
      </div>
      
      <script>

    var iptr;
    var fptr;
    var cptr;
    var fptr;

    var notes;

    //var show_all = true;
    //var single_record = "@I6@";

    
    var ged_objects;

    

    


    var sgallery;

    var generation_titles = ["Descendants Table", "Children", "Grand Children", "Great Grand Children",
        "4th Generation", "5th Generation", "6th Generatipn", "7th Generatipn", "8th Generatipn"];
    var descendants = [];
    var generation = 0;

    var generations_to_show = 4;

    read_ged_file();

    var id = get_url_var("id");
    var orig = get_url_var("orig");
    var family = get_url_var("family");
    console.log("ID: %s orig: %s family: %s", id, orig, family);

    var family_key = "";
    var family2 = "";
    var ipos1;
    var ipos2;

    // https://ourfolkgen.com/ourfolk/descendants.htm?orig=hart.htm
    if (orig != "")
    {
        ipos = orig.indexOf(".");
        if (ipos >= 0)
        {
            family = orig.substr(0, ipos);  
            family = family.replace(/-/g, " ");
            console.log("orig family: %s", family);
        }
        console.log("IPOS: %s family: %s", ipos, family);
    }


    if (family != "")
    {
        family = family.toLowerCase();
        // e%20Arundel_0 - we want the top family with this name
        ipos1 = family.indexOf("_");
        if (ipos1 > 0)
        {
            family = family.substr(0, ipos1);  
            console.log("_0: family: %s", family);
        }
        else
        {
            // johnston-wallace works well
            ipos2 = family.indexOf("-");
            if (ipos2 > 0)
            {
                family2 = family.substr(ipos2 + 1);
                family = family.substr(0, ipos2);
                
                console.log("dash: family: %s family2: %s", family, family2);
                if (family2.substr(0,1) == "-")
                    family2 = "";

                
            }
        }
        console.log("IPOS: %s IPOS1: %s ipos2: %s family: %s family2: %s", ipos, ipos1, ipos2, family, family2);
 
        
    }
   

    if (family != "")
    {
        

        if (false && family2 == "")
        {
            // for known families, just go there
            if (family == "hart")
                id = 98;
            else if (family == "kimball")
                id = 439;
            else if (family == "bibbins")
                id = 443;
            else if (family == "johnston")
                id = 468;
            else if (family == "adams")
                id = 427;
            else if (family == "smith")
                id = 2390;
            else if (family == "erikson")
                id = 440;
            else if (family == "erikson")
                id = 440;
            console.log("ID: %s family: %s", id, family, ipos1, ipos2);
        }
        

        // loop through to find this family pair
       if (id == "" && family != "")
       {
            var keys = Object.keys(ged_objects);
            //console.log("KEYS.length: %s", keys.length);

            for (var ik = 0; ik < keys.length; ik++)
            {
                key = keys[ik];
                //console.log("ik: %s %s", ik, key);
                if (key.substr(0,2) == "@F")
                    break;
                if (key.substr(0,2) != "@I")
                    continue;
                iptr = get_person(key);
                
                //console.log("IPTR: %s last_name: %s (family: %s)", iptr.id, iptr.last_name.toLowerCase(), family.toLowerCase());

                if (iptr.last_name.toLowerCase() == family.toLowerCase())
                {
                    console.log("IPTR: %s %s FAMILY: %s", iptr.id, iptr.full_name, family);
                    var fams_array = get_values_array(iptr.FAMS); // array of one or more values
                    if (family_key == "")
                        family_key = key;

                    if (family2 == "")
                        continue;
                    for (var ifam = 0; ifam < fams_array.length; ifam++)
                    {
                        fams = fams_array[ifam];

                        fptr = ged_objects[fams];
                        if (!fptr)
                        {
                            console.log("FAMILY NOT FOUND: %s", fams);
                            continue;
                        }

                        // find spouse with family2 name
                        var spouse_record = get_spouse_record(iptr, fptr);
                        if (spouse_record)
                        {
                            console.log("spouse_record: %s last_name: %s family2 %s", spouse_record.id, spouse_record.last_name, family2.toLowerCase());
                            if (spouse_record.last_name.toLowerCase() == family2.toLowerCase())
                            {     
                                console.log("FAMILY2 FOUND: spouse_record: %s %s", spouse_record.id, spouse_record.full_name);  
                                id = iptr.id;
                                break;
                            }
                        }

                    }
                    console.log("ID: %s family_key: %s", id, family_key);

                }
                if (id != "")
                    break;    
            }
            console.log("At end of family 2 search: ID: %s family_key: %s", id, family_key);
            if (id == "")
            {
                if (family_key != "")
                {
                    key = family_key;

                    iptr = get_person(key);
                    
                    console.log("FAMILY_KEY: %s IPTR: %s %s (%s", iptr.id, iptr.last_name.toLowerCase(), family_key, family.toLowerCase());

                    
                    
                    if (iptr.last_name.toLowerCase() == family.toLowerCase())
                    {
                        // get top ancestor
                        //console.log("IPTR: %s %s FAMILY: %s", iptr.id, iptr.full_name, family);
                        while (iptr.FAMC)
                        {
                            pptr = ged_objects[iptr.FAMC];
                            console.log("pptr: %s HUSB: %s", pptr.code, pptr.HUSB);
                            if (pptr && pptr.HUSB)
                                iptr = get_person(pptr.HUSB);
                            else
                                break;
                        }
                        id = iptr.code;
                        console.log("TOP: ID: %s %s", id, iptr.full_name);

                    }
                }
            }

       }

       //console.log("ID: %s", id);
    }



    if (id != "" && String(id).substr(0,1) != "@")
       id = "@I" + id + "@";


    console.log("GET DESCANDANTS: ID: %s", id);

    if (!id)
        throw("ID not found");

    do_descendants(id);

    

    function do_descendants(id)
    {
        
        console.log(get_self(id));
        generation = 0;
        descendants[0] = [id];

        for (generation = 0; generation < generations_to_show; generation++)
        {
            console.log("generation: %s/%s descendants.length: %s", generation, generations_to_show, descendants[generation].length);
            descendants[generation + 1] = [];
            for (idesc = 0; idesc < descendants[generation].length; idesc++)
            {
    

                id_desc = descendants[generation][idesc];
                desc_obj = ged_objects[id_desc];


                console.log("generation: %s descendant id_desc: %s", generation, id_desc);

                var fams_array = get_values_array(desc_obj.FAMS); // array of one or more values

                for (var ifam = 0; ifam < fams_array.length; ifam++)
                {
                    fams = fams_array[ifam];
                    fptr = ged_objects[fams];
                    console.log("ifam: %s fptr %s HUSB: %s WIFE: %s CHIL: %s", ifam, fptr.id, fptr.HUSB, fptr.WIFE, show_object(fptr.CHIL));


                    if (fptr)
                    {
                        var carray = get_values_array(fptr.CHIL);
                        for (ic = 0; ic < carray.length; ic++)
                        {
                            ckey = carray[ic];
                            console.log("fams: %s ckey: %s ", fams, ckey);
                            if (in_array(descendants[generation + 1], ckey) >= 0)
                            {
                                console.log("SKIP CHILD: (already in array) fams: %s CHIL: %s ckey: %s", fams, show_object(fptr.CHIL), ckey);
                                continue;
                            }
                            console.log("Add to descendants[%s]: %s", generation+1, ckey);
                            add_to_array(descendants[generation + 1], ckey);
                        }

                            
                    }
                }

            }

            

        }


        sleft = "";
        sgallery = `<div class="row">\n`;

        for (generation = 0; generation < generations_to_show; generation++)
        {
            console.log("generation: %s", generation);
            do_generation(generation);

        }


        sleft += "<br>";

        elt = document.getElementById("ged_out");
        elt.innerHTML = sleft;
        console.log("ged_out set");
    }

    function do_generation(generation)
    {
        console.log(get_self(generation));
 

        

    
        if (generation == 0)
        {
            id_desc = descendants[generation][0];
            iptr = get_person(id_desc);
            
            document.title = "Descendants of " + iptr.full_name ;

            sleft += sprintf("<div class='generation'>Descendants of %s</div>\n", iptr.full_name);
        }
        else
            sleft += sprintf("<br><div class='generation'>%s</div>\n", generation_titles[generation]);

  
        for (idesc = 0; idesc < descendants[generation].length; idesc++)
        {

            id_desc = descendants[generation][idesc];
            
            iptr = get_person(id_desc);
            
            console.log("generation: %s IPTR id_desc: %s %s", generation, id_desc, iptr.full_name);
            sleft += "<br><hr>";

            sleft += sprintf("<div class='descendant'>%s - %s</div><br>\n", iptr.full_name, get_short_full_dates(iptr));


            
            sleft += "<div style='text-align: center; width:25%; padding-bottom: 15px; padding-right: 15px; float: left; display: block;'>\n";

            get_first_image(iptr, "left", "", true);

            sleft += "</div>\n";

        
      
            //sleft += sprintf("<b>Descendant: %s - %s</b><br><br>\n", output_fullname(iptr,"LINK_MARRIAGE","NO_ANCHOR","name","NO_SPACE", "NO_INDEX"), get_short_full_dates(iptr));

            sleft += show_dates(iptr);
            

            
            

            sleft += get_parents(iptr, false);


                
            var fams_array = get_values_array(iptr.FAMS); // array of one or more values
            
            // get each spouse
            for (var ifam = 0; ifam < fams_array.length; ifam++)
            {
                fams = fams_array[ifam];

                fptr = ged_objects[fams];
                if (!fptr)
                {
                    console.log("FAMILY NOT FOUND: %s", fams);
                    continue;
                }
                console.log("fptr %s HUSB: %s WIFE: %s CHIL: %s", fptr.id, fptr.HUSB, fptr.WIFE, show_object(fptr.CHIL));
                var carray = get_values_array(fptr.CHIL);

                

            
                var spouse_record = get_spouse_record(iptr, fptr);
                if (spouse_record)
                {
                    sleft += sprintf("<br><br>%s was married to ", iptr.salutation);
                    sleft += output_fullname(spouse_record,"LINK_MARRIAGE","NO_ANCHOR","name","NO_SPACE", "NO_INDEX");
            
                

            
                    sleft += ".<br>\n";
    
    
        

            
                    sleft += show_dates(spouse_record);

                    // only show parents if our descendant
                    // make sure we have the proper parent.
                    console.log("SPOUSE: %s %s", spouse_record.id, spouse_record.full_name);
                    
                    console.log("fams: %s iptr.code: %s %s in_array: %s", fams, iptr.code, in_array(carray, iptr.code, iptr.full_name));
                    if (in_array(carray, iptr.code) < 0)
                    {
                        console.log("SKIP FAMILY: fams: %s %s iptr.code: %s", fams, iptr.code, iptr.full_name);
                        continue;
                    }


                    sleft += get_parents(spouse_record, false);
                }


    
            }
            
            sleft += "<br clear=all>";
            sleft += sprintf(`<a href='ged_person.htm?id=%s'><button type='button' class='btn btn-info'>Show Family</button></a>`, iptr.id);
            sleft += sprintf(` - <a href='ancestors.htm?id=%s'><button type='button' class='btn btn-info'>Ancestors</button></a><br>`, iptr.id);
        }

 

        

    



    }

    
    </script>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="./flatlab/js/jquery.js"></script>
    <script src="./flatlab/js/bootstrap.bundle.min.js"></script>
    <script class="include" type="text/javascript" src="./flatlab/js/jquery.dcjqaccordion.2.7.js"></script>
    
    <!-- for image gallery -->
    <script src="./flatlab/assets/fancybox/source/jquery.fancybox.js"></script>
    
    
    <script src="./flatlab/js/jquery.scrollTo.min.js"></script>
    <script src="./flatlab/js/slidebars.min.js"></script>
    <script src="./flatlab/js/jquery.nicescroll.js" type="text/javascript"></script>
    <script src="./flatlab/js/respond.min.js" ></script>

    <!--common script for all pages-->
    <script src="./flatlab/js/common-scripts.js"></script>

	<!-- for image gallery -->
    <script src="./flatlab/js/modernizr.custom.js"></script>
    <script src="./flatlab/js/toucheffects.js"></script>

  <script type="text/javascript">
  	// for image gallery
      $(function() {
        //    fancybox
          jQuery(".fancybox").fancybox();
      });

  </script>


  </body>
</html>
